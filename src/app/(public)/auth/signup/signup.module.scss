@use ".././../../styles/variables" as *;

.modalOverlay {
  position: fixed;
  inset: 0;
  z-index: $z-modal-backdrop;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: rgba(0, 0, 0, 0.5);
  backdrop-filter: $backdrop-blur-sm;
  
  // Prevent background transparency issues
  -webkit-backdrop-filter: $backdrop-blur-sm;
}

.modalContainer {
  background-color: var(--modal-bg, white);
  color: var(--modal-text, $gray-900);
  border: 1px solid var(--modal-border, $gray-200);
  border-radius: $radius-md;
  box-shadow: $shadow-xl;
  max-width: 400px;
  width: 90%;
  padding: $spacing-xl;
  position: relative;
  transition: $transition-all;
  
  // Ensure background is not transparent
  opacity: 1;
  
  @include dark {
    background-color: var(--modal-bg, $dark-bg-card);
    color: var(--modal-text, $dark-text-primary);
    border-color: var(--modal-border, $dark-border);
    box-shadow: $shadow-dark-xl;
  }
}

.modalHeader {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: $spacing-lg;
}

.modalTitle {
  font-size: $text-xl;
  font-weight: $font-semibold;
  color: var(--modal-text, $gray-900);
  margin: 0;
  
  @include dark {
    color: var(--modal-text, $dark-text-primary);
  }
}

.modalClose {
  position: absolute;
  top: -0.6rem;
  right: -0.6rem;
  font-size: $text-2xl;
  line-height: 1;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: $error;
  background: transparent;
  border: none;
  border-radius: $radius-sm;
  cursor: pointer;
  transition: $transition-colors;
  z-index: $z-base; // Ensure close button stays on top
  
  &:hover {
    color: lighten($error, 10%);
    background-color: rgba($error, 0.1);
  }
  
  @include dark {
    &:hover {
      color: lighten($error, 20%);
      background-color: rgba($error, 0.2);
    }
  }
}

.modalBody {
  margin-bottom: $spacing-lg;
}

.modalInput {
  width: 100%;
  padding: $spacing-sm $spacing-md;
  border-radius: $radius-sm;
  background: var(--modal-bg-secondary, $gray-50);
  border: 1px solid var(--modal-border, $gray-300);
  color: var(--modal-text, $gray-900);
  font-size: $text-base;
  outline: none;
  transition: $transition-colors;
  margin-bottom: $spacing-sm;
  
  &:focus {
    border-color: $primary-500;
    box-shadow: 0 0 0 3px rgba($primary-500, 0.1);
  }
  
  @include dark {
    background: var(--modal-bg-secondary, $dark-bg-secondary);
    border-color: var(--modal-border, $dark-border);
    color: var(--modal-text, $dark-text-primary);
    
    &:focus {
      border-color: $primary-400;
      box-shadow: 0 0 0 3px rgba($primary-400, 0.2);
    }
  }
}

.modalBtn {
  width: 100%;
  padding: $spacing-md;
  border: none;
  border-radius: $radius-sm;
  background: $primary-500;
  color: white;
  font-size: $text-base;
  font-weight: $font-semibold;
  cursor: pointer;
  transition: $transition-all;
  margin-top: $spacing-md;
  
  &:hover {
    background: $primary-600;
    transform: translateY(-1px);
    box-shadow: $shadow-md;
  }
  
  &:active {
    transform: translateY(0);
  }
  
  @include dark {
    background: $primary-400;
    
    &:hover {
      background: $primary-300;
    }
  }
}

/* --- ROLE TOGGLE SWITCH --- */

.roleToggleWrapper {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: $spacing-lg;
  padding: $spacing-sm;
  background: var(--modal-bg-secondary, $gray-100);
  border-radius: $radius-sm;
  border: 1px solid var(--modal-border, $gray-200);
  
  @include dark {
    background: var(--modal-bg-secondary, $dark-bg-secondary);
    border-color: var(--modal-border, $dark-border);
  }
}

.roleToggleLabel {
  color: var(--modal-text, $gray-700);
  font-weight: $font-medium;
  font-size: $text-sm;
  
  @include dark {
    color: var(--modal-text, $dark-text-secondary);
  }
}

.roleToggle {
  display: flex;
  align-items: center;
  gap: $spacing-xs;
}

.roleToggleBtn {
  appearance: none;
  width: 48px;
  height: 24px;
  background: $gray-300;
  border-radius: $radius-full;
  position: relative;
  cursor: pointer;
  transition: background .3s ease;
  
  &::after {
    content: "";
    position: absolute;
    top: 3px;
    left: 3px;
    width: 18px;
    height: 18px;
    border-radius: $radius-full;
    background: white;
    transition: transform .3s ease;
    box-shadow: $shadow-sm;
  }
  
  &:checked {
    background: $primary-500;
    
    &::after {
      transform: translateX(24px);
    }
  }
  
  @include dark {
    background: $dark-border;
    
    &:checked {
      background: $primary-400;
      
      &::after {
        background: $dark-text-primary;
      }
    }
  }
}

.errorMessage,
.passwordError {
  color: $error;
  font-size: $text-sm;
  text-align: center;
  margin-top: $spacing-sm;
  padding: $spacing-xs $spacing-sm;
  background: rgba($error, 0.1);
  border-radius: $radius-sm;
  border: 1px solid rgba($error, 0.2);
  
  @include dark {
    background: rgba($error, 0.2);
    border-color: rgba($error, 0.3);
  }
}

/* Light theme CSS variables */
:root {
  --modal-bg: #ffffff;
  --modal-bg-secondary: #{$gray-50};
  --modal-text: #{$gray-900};
  --modal-border: #{$gray-200};
}

/* Dark theme CSS variables */
:global(.dark) {
  --modal-bg: #{$dark-bg-card};
  --modal-bg-secondary: #{$dark-bg-secondary};
  --modal-text: #{$dark-text-primary};
  --modal-border: #{$dark-border};
}